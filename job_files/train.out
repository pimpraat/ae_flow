21
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Recon loss: 1.2703121900558472, Flow loss: 242911.359375
Recon loss: 1.3114409446716309, Flow loss: 241148.15625
Recon loss: 1.2927229404449463, Flow loss: 239579.453125
Recon loss: 1.2761542797088623, Flow loss: 237855.65625
Recon loss: 1.3203535079956055, Flow loss: 235643.609375
Recon loss: 1.2671761512756348, Flow loss: 232663.21875
Recon loss: 1.2699772119522095, Flow loss: 228569.4375
Recon loss: 1.2744287252426147, Flow loss: 223220.296875
Recon loss: 1.3191404342651367, Flow loss: 216277.1875
Recon loss: 1.2318894863128662, Flow loss: 207198.0
Recon loss: 1.1646760702133179, Flow loss: 196122.75
Recon loss: 1.2119780778884888, Flow loss: 183126.71875
Recon loss: 1.1840664148330688, Flow loss: 168580.25
Recon loss: 1.1632955074310303, Flow loss: 151128.125
Recon loss: 1.1128489971160889, Flow loss: 132648.25
Recon loss: 1.1013115644454956, Flow loss: 113724.046875
Recon loss: 1.0813894271850586, Flow loss: 94154.7421875
Recon loss: 1.0880160331726074, Flow loss: 74135.328125
Recon loss: 1.0755155086517334, Flow loss: 54097.44140625
Recon loss: 1.0916656255722046, Flow loss: 32772.109375
Recon loss: 0.9917972683906555, Flow loss: 10015.443359375
====> Epoch 0 : Average loss: 83704.6831
Now moving onto finding the appropriate threshold (based on training data):
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 due to no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1609: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 due to no true nor predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, "true nor predicted", "F-score is", len(true_sum))
Found optimal threshold: 0.0
Epoch 0: {'AUC': 0.4375, 'ACC': 0.4375, 'SEN': 0.0, 'SPE': 0.875, 'F1': 0.0}
Duration for epoch 0: 26.47182607650757
Recon loss: 0.9227756261825562, Flow loss: -14204.8515625
Recon loss: 0.9624881148338318, Flow loss: -37940.2578125
Recon loss: 0.9693774580955505, Flow loss: -63133.078125
Recon loss: 0.8861299753189087, Flow loss: -88665.375
Recon loss: 0.8356944918632507, Flow loss: -107119.765625
Recon loss: 0.8831148147583008, Flow loss: -117145.296875
Recon loss: 0.8996710777282715, Flow loss: -135592.828125
Recon loss: 0.84967440366745, Flow loss: -163295.09375
Recon loss: 0.7903513312339783, Flow loss: -192697.640625
Recon loss: 0.7602609395980835, Flow loss: -208460.796875
Recon loss: 0.8054062724113464, Flow loss: -231869.8125
Recon loss: 0.7941756248474121, Flow loss: -252739.8125
Recon loss: 0.7841825485229492, Flow loss: -263568.71875
Recon loss: 0.8092937469482422, Flow loss: -272778.6875
Recon loss: 0.7681053876876831, Flow loss: -291270.28125
Recon loss: 0.779920756816864, Flow loss: -309892.9375
Recon loss: 0.7347830533981323, Flow loss: -336875.40625
Recon loss: 0.7841329574584961, Flow loss: -349276.0
Recon loss: 0.7290749549865723, Flow loss: -368391.9375
Recon loss: 0.6851518154144287, Flow loss: -384109.53125
Recon loss: 0.6875370740890503, Flow loss: -402241.75
====> Epoch 1 : Average loss: -109315.5405
Duration for epoch 1: 15.997339963912964
Recon loss: 0.7318935394287109, Flow loss: -405165.8125
Recon loss: 0.8383840918540955, Flow loss: -395854.875
Recon loss: 0.7466875910758972, Flow loss: -405461.375
Recon loss: 0.8888298869132996, Flow loss: -425991.625
Recon loss: 0.8580464124679565, Flow loss: -457464.1875
Recon loss: 0.693263053894043, Flow loss: -461236.59375
Recon loss: 0.69036865234375, Flow loss: -472926.96875
Recon loss: 0.8287696838378906, Flow loss: -489732.4375
Recon loss: 0.8325939178466797, Flow loss: -506637.5
Recon loss: 0.6918329000473022, Flow loss: -515280.5625
Recon loss: 0.7154409289360046, Flow loss: -533231.6875
Recon loss: 0.6538984775543213, Flow loss: -545839.8125
Recon loss: 0.6620547771453857, Flow loss: -554799.125
Recon loss: 0.7771540880203247, Flow loss: -557975.5
Recon loss: 0.6120491027832031, Flow loss: -573512.0
Recon loss: 0.8005697131156921, Flow loss: -582597.5625
Recon loss: 0.6807293891906738, Flow loss: -589034.125
Recon loss: 0.7391281127929688, Flow loss: -603272.0
Recon loss: 0.9180697798728943, Flow loss: -612849.0
Recon loss: 0.8562717437744141, Flow loss: -616308.0
Recon loss: 0.7867365479469299, Flow loss: -626028.5625
====> Epoch 2 : Average loss: -260266.2686
Duration for epoch 2: 16.080817222595215
Recon loss: 0.5692013502120972, Flow loss: -620981.125
Recon loss: 0.5946284532546997, Flow loss: -644050.6875
Recon loss: 0.753894031047821, Flow loss: -643592.5
Recon loss: 1.4175814390182495, Flow loss: -629665.1875
Recon loss: 0.5856342315673828, Flow loss: -644201.75
Recon loss: 0.7652567625045776, Flow loss: -650456.0
Recon loss: 0.680854320526123, Flow loss: -649066.0625
Recon loss: 0.6917487978935242, Flow loss: -643329.5
Recon loss: 0.7438429594039917, Flow loss: -673867.8125
Recon loss: 0.8653945922851562, Flow loss: -676091.375
Recon loss: 0.691412627696991, Flow loss: -690573.5
Recon loss: 0.6283313035964966, Flow loss: -688850.875
Recon loss: 0.6067497730255127, Flow loss: -703769.75
Recon loss: 0.6082348823547363, Flow loss: -717699.5
Recon loss: 0.6095485091209412, Flow loss: -720958.0625
Recon loss: 0.5700074434280396, Flow loss: -732530.75
Recon loss: 0.6272663474082947, Flow loss: -737879.875
Recon loss: 0.5810540914535522, Flow loss: -750777.375
Recon loss: 0.5913535952568054, Flow loss: -753675.5
Recon loss: 0.5827645063400269, Flow loss: -759976.125
Recon loss: 0.6364601850509644, Flow loss: -762018.5625
====> Epoch 3 : Average loss: -345095.1786
Duration for epoch 3: 16.040509700775146
Recon loss: 0.5759531259536743, Flow loss: -743561.4375
Recon loss: 0.6270360946655273, Flow loss: -770412.125
Recon loss: 0.5563699007034302, Flow loss: -768923.125
Recon loss: 0.5589607954025269, Flow loss: -758280.3125
Recon loss: 0.6218170523643494, Flow loss: -781488.5
Recon loss: 0.5604939460754395, Flow loss: -782656.125
Recon loss: 0.5372825860977173, Flow loss: -794586.0
Recon loss: 0.6462864875793457, Flow loss: -801940.4375
Recon loss: 0.6547826528549194, Flow loss: -810038.375
Recon loss: 0.611504316329956, Flow loss: -813750.375
Recon loss: 0.6765381693840027, Flow loss: -813044.625
Recon loss: 0.7640447616577148, Flow loss: -815237.625
Recon loss: 0.9244360327720642, Flow loss: -776446.875
Recon loss: 0.9096672534942627, Flow loss: -804403.3125
Recon loss: 0.6978374719619751, Flow loss: -794803.5625
Recon loss: 0.6843069791793823, Flow loss: -777073.25
Recon loss: 0.6775471568107605, Flow loss: -779947.75
Recon loss: 0.5899227261543274, Flow loss: -814239.25
Recon loss: 0.62246173620224, Flow loss: -818814.6875
Recon loss: 0.6238971948623657, Flow loss: -825698.625
Recon loss: 0.6874141097068787, Flow loss: -828471.1875
====> Epoch 4 : Average loss: -396995.3274
Duration for epoch 4: 16.28925895690918
Recon loss: 0.7268649935722351, Flow loss: -842678.0625
Recon loss: 0.7258111834526062, Flow loss: -847696.375
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 11734821 ON r28n4 CANCELLED AT 2023-05-07T10:53:46 ***
slurmstepd: error: *** STEP 11734821.0 ON r28n4 CANCELLED AT 2023-05-07T10:53:46 ***
