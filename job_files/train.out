wandb: Currently logged in as: pimpraat (dl2_ae_flow). Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /home/lcur1624/.netrc
wandb: wandb version 0.15.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.0
wandb: Run data is saved locally in /home/lcur1624/ae_flow/wandb/run-20230511_113150-59gydtjm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-pyramid-160
wandb: ⭐️ View project at https://wandb.ai/dl2_ae_flow/ae_flow
wandb: 🚀 View run at https://wandb.ai/dl2_ae_flow/ae_flow/runs/59gydtjm
Length of the train loader: 21 given a batch size of 64
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/lcur1624/.conda/envs/dl2022/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Wide_ResNet50_2_Weights.IMAGENET1K_V1`. You can also use `weights=Wide_ResNet50_2_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
====> Epoch 0 : Average loss: 0.9005
Now moving onto finding the appropriate threshold (based on training data):
Optimal threshold: -1.042621648788459
Number of predicted anomalies in the test-set: 410
Epoch 0: {'AUC': 0.4717948717948718, 'ACC': 0.5128205128205128, 'SEN': 0.6358974358974359, 'SPE': 0.3076923076923077, 'F1': 0.62}
Duration for epoch 0: 69.59895730018616
====> Epoch 1 : Average loss: -0.3737
Now moving onto finding the appropriate threshold (based on training data):
Optimal threshold: -1.2428559532165666
Number of predicted anomalies in the test-set: 258
Epoch 1: {'AUC': 0.6256410256410256, 'ACC': 0.5961538461538461, 'SEN': 0.5076923076923077, 'SPE': 0.7435897435897436, 'F1': 0.611111111111111}
Duration for epoch 1: 67.90467858314514
====> Epoch 2 : Average loss: -1.1916
Now moving onto finding the appropriate threshold (based on training data):
Optimal threshold: -1.2290431079864605
Number of predicted anomalies in the test-set: 274
Epoch 2: {'AUC': 0.6119658119658119, 'ACC': 0.5897435897435898, 'SEN': 0.5230769230769231, 'SPE': 0.7008547008547008, 'F1': 0.6144578313253012}
Duration for epoch 2: 68.64839339256287
====> Epoch 3 : Average loss: -1.7439
Now moving onto finding the appropriate threshold (based on training data):
Optimal threshold: -1.1639917097091734
Number of predicted anomalies in the test-set: 252
Epoch 3: {'AUC': 0.6008547008547009, 'ACC': 0.5705128205128205, 'SEN': 0.4794871794871795, 'SPE': 0.7222222222222222, 'F1': 0.5825545171339563}
Duration for epoch 3: 70.87603211402893
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 11747718 ON r36n5 CANCELLED AT 2023-05-11T11:38:12 ***
